<!DOCTYPE html>
<html>
<head>
  <title>LinkedIn Message Studio Settings</title>
  <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body class="app settings">
  <div class="container">
    <header class="header">
      <div class="brand">
        <span class="brand-badge">AI</span>
        <div>
          <h1>Studio Settings</h1>
          <p class="subtitle">Configure your profile, prompt, and tasks.</p>
        </div>
      </div>
      <button id="backButton" class="ghost-button" type="button">Back</button>
    </header>

    <section class="panel">
      <h2>Appearance</h2>
      <p class="helper-text">Choose how the extension should look.</p>
      <label class="field">
        <span>Theme</span>
        <select id="themeSelect">
          <option value="system">System</option>
          <option value="light">Light</option>
          <option value="dark">Dark</option>
        </select>
      </label>
    </section>

    <section class="panel">
      <h2>OpenAI API key</h2>
      <p class="helper-text">Your key stays in local storage and is never shared outside the extension.</p>
      <div class="field horizontal">
        <input type="password" id="openAiApiInput" placeholder="sk-..." required>
        <button id="toggleApiVisibility" class="ghost-button" type="button">Show</button>
      </div>
    </section>

    <section class="panel">
      <h2>Your LinkedIn profile</h2>
      <p class="helper-text">Paste a short summary or load it from the open LinkedIn tab.</p>
      <div class="field">
        <textarea id="userProfile" rows="4" placeholder="Share your headline, key roles, and focus areas."></textarea>
      </div>
      <button id="loadUserProfile" class="secondary" type="button">Load from active tab</button>
    </section>

    <section class="panel">
      <h2>System prompt</h2>
      <p class="helper-text">Keep this default for best results, or customize for advanced workflows.</p>
      <div class="field">
        <textarea id="systemPrompt" rows="6" placeholder="Enter system prompt"></textarea>
      </div>
      <button id="default-system-prompt-button" class="ghost-button" type="button">Restore default</button>
    </section>

    <section class="panel">
      <div class="panel-header">
        <h2>Saved tasks</h2>
        <button id="removeAllTasksButton" class="ghost-button small" type="button">Remove all</button>
      </div>
      <div class="task-header">
        <p>Task name</p>
        <p>Task description</p>
        <span></span>
      </div>
      <div id="task-list" class="task-list"></div>
      <div class="field grid two">
        <input type="text" id="newTaskKey" placeholder="Enter task name">
        <input type="text" id="newTaskValue" placeholder="Enter task description">
      </div>
      <button id="addTaskButton" class="secondary" type="button">Add task</button>
    </section>

    <div class="button-row">
      <button id="saveSettingsButton" class="primary" type="button">Save settings</button>
    </div>
  </div>

  <script>
    (() => {
      const THEME_KEY = "themePreference";
      const THEMES = new Set(["system", "light", "dark"]);

      const normalizeTheme = (value) => (THEMES.has(value) ? value : "system");
      const applyTheme = (theme) => {
        const normalizedTheme = normalizeTheme(theme);
        document.body.classList.remove("theme-system", "theme-light", "theme-dark");
        document.body.classList.add(`theme-${normalizedTheme}`);
      };

      const savedTheme = normalizeTheme(localStorage.getItem(THEME_KEY));
      applyTheme(savedTheme);

      const themeSelect = document.getElementById("themeSelect");
      if (themeSelect) {
        themeSelect.value = savedTheme;
        themeSelect.addEventListener("change", (event) => {
          const nextTheme = normalizeTheme(event.target.value);
          localStorage.setItem(THEME_KEY, nextTheme);
          applyTheme(nextTheme);
        });
      }
    })();
  </script>
  <script type="module" src="dist/settings.bundle.js"></script>
</body>
</html>
